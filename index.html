<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Painel de Mobilidade</title>
    <style>
        :root {
            --primary: #4361ee;
            --dark: #212529;
            --light: #f8f9fa;
        }

        body { 
            font-family: 'Inter', system-ui, -apple-system, sans-serif; 
            background: #eef2f7; 
            margin: 0; 
            padding: 10px;
            color: var(--dark);
        }

        .container { max-width: 1000px; margin: 0 auto; }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .header h2 { font-size: 1.2rem; margin: 0; color: var(--primary); }

        input { 
            width: 100%; 
            padding: 12px 15px; 
            border: none; 
            border-radius: 10px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            font-size: 16px;
            box-sizing: border-box;
            outline: none;
            margin-bottom: 20px;
        }

        .table-wrapper {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        table { 
            border-collapse: collapse; 
            width: 100%; 
            min-width: 600px; 
        }

        th { 
            background-color: #fcfcfd; 
            color: #6c757d; 
            font-weight: 600; 
            text-transform: uppercase; 
            font-size: 0.75rem; 
            padding: 15px; 
            text-align: left; 
            border-bottom: 2px solid #f1f3f5;
        }

        td { 
            padding: 15px; 
            border-bottom: 1px solid #f1f3f5; 
            font-size: 0.9rem; 
        }

        tr:last-child td { border-bottom: none; }
        tr:hover { background-color: #f8f9ff; }

        strong { color: var(--primary); }
    </style>
</head>
<body>

    <div class="container">
        <div class="header">
            <h2>ðŸšŒ Consulta de ItinerÃ¡rios</h2>
            <div id="relogio" style="font-weight: bold; font-size: 0.9rem;">00:00:00</div>
        </div>

        <input type="text" id="search" placeholder="Buscar bairro, ponto ou linha...">

        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>Bairro</th>
                        <th>Ponto de Passagem</th>
                        <th>Parada</th>
                        <th>Linha</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </div>

    <script>
        let pontos = [];
        const tableBody = document.getElementById("tableBody");

        // RelÃ³gio simples apenas para referÃªncia
        setInterval(() => {
            document.getElementById('relogio').innerText = new Date().toLocaleTimeString('pt-br');
        }, 1000);

        async function carregarCSV() {
            try {
                const response = await fetch('pontos.csv');
                const data = await response.text();
                const linhas = data.split(/\r?\n/).filter(l => l.trim() !== "");
                
                pontos = linhas.slice(1).map(linha => {
                    const col = linha.split(',');
                    return { 
                        bairro: col[0]?.trim(), 
                        ponto: col[1]?.trim(), 
                        parada: col[2]?.trim(), 
                        linha: col[3]?.trim()
                    };
                });
                
                mostrarTabela(pontos);
            } catch (error) { 
                console.error("Erro ao carregar CSV:", error);
                tableBody.innerHTML = "<tr><td colspan='4'>Erro ao carregar dados.</td></tr>";
            }
        }

        function mostrarTabela(lista) {
            tableBody.innerHTML = "";
            lista.forEach(p => {
                tableBody.innerHTML += `
                    <tr>
                        <td><strong>${p.bairro || '-'}</strong></td>
                        <td>${p.ponto || '-'}</td>
                        <td>${p.parada || '-'}</td>
                        <td>${p.linha || '-'}</td>
                    </tr>`;
            });
        }

        document.getElementById("search").addEventListener("input", (e) => {
            const v = e.target.value.toLowerCase();
            const f = pontos.filter(p => 
                Object.values(p).some(val => val && val.toLowerCase().includes(v))
            );
            mostrarTabela(f);
        });

        carregarCSV();
    </script>
</body>
</html>
